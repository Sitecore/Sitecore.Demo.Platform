---
ID: "bc6f211f-0ef9-4bda-b97d-cca91c986cf0"
Parent: "594d7d33-1176-417b-864a-e8810e5d2946"
Template: "962b53c4-f93b-4df9-9821-415c867b8903"
Path: "/sitecore/media library/Themes/Habitat Sites/Habitat Home/scripts/component-overlay"
DB: master
SharedFields:
- ID: "06d5295c-ed2f-4a54-9bf2-26228d113318"
  Hint: __Icon
  Value: "-/media/430777640C4240E390D3FD00B7F1F2A2.ashx?h=16&thn=1&w=16"
- ID: "40e50ed9-ba07-4702-992e-a912738d32dc"
  Hint: Blob
  BlobID: "072eb84b-544f-471a-bd28-70f7f846922e"
  Value: 77u/LyogZ2xvYmFsIFhBQ29udGV4dDpmYWxzZSwgbWVqczpmYWxzZSAqLw0KWEEuY29tcG9uZW50Lm92ZXJsYXkgPSBmdW5jdGlvbigkKSB7DQoNCiAgICB2YXIgYXBpID0ge30sDQogICAgICAgIGhyZWYgPSB3aW5kb3cubG9jYXRpb24uaHJlZiwNCiAgICAgICAgaG9zdCA9IGxvY2F0aW9uLmhvc3QsDQogICAgICAgIGxhYmVsLA0KICAgICAgICBvdmVybGF5UGxhY2Vob2xkZXIgPSBmYWxzZSwNCiAgICAgICAgbWFyZ2luVG9wID0gMTAwOw0KDQogICAgZnVuY3Rpb24gaXNQcmV2aWV3TW9kZSgpIHsNCiAgICAgICAgaWYgKGhyZWYuaW5kZXhPZigic2NfbW9kZT1wcmV2aWV3IikgPiAtMSkgew0KICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgIH0NCiAgICAgICAgdmFyICRoZFBhZ2VNb2RlID0gJCgnI2hkUGFnZU1vZGUnKTsNCg0KICAgICAgICByZXR1cm4gJGhkUGFnZU1vZGUubGVuZ3RoID4gMCAmJiAkaGRQYWdlTW9kZS5hdHRyKCd2YWx1ZScpID09ICdwcmV2aWV3JzsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBpc0VkaXRNb2RlKCkgew0KICAgICAgICBpZiAoaHJlZi5pbmRleE9mKCJzY19tb2RlPWVkaXQiKSA+IC0xKSB7DQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgfQ0KDQoNCiAgICAgICAgdmFyICRoZFBhZ2VNb2RlID0gJCgnI2hkUGFnZU1vZGUnKTsNCg0KICAgICAgICByZXR1cm4gJGhkUGFnZU1vZGUubGVuZ3RoID4gMCAmJiAkaGRQYWdlTW9kZS5hdHRyKCd2YWx1ZScpID09ICdlZGl0JzsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBpc092ZXJsYXlQYWdlKCkgew0KICAgICAgICByZXR1cm4gJCgnI3dyYXBwZXInKS5oYXNDbGFzcygnb3ZlcmxheS1wYWdlJyk7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gaGFzT3ZlcmxheUNvbnRlbnQoKSB7DQogICAgICAgIHJldHVybiAkKCIub3ZlcmxheS1zb3VyY2UiKS5sZW5ndGg7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gcmVzaXplT3ZlcmxheShpbm5lciwgY29udGVudCwgb3B0aW9ucykgew0KICAgICAgICB2YXIgdW5pdCA9ICJweCI7DQogICAgICAgIHZhciBjc3MgPSB7DQogICAgICAgICAgICAid2lkdGgiOiAiIiwNCiAgICAgICAgICAgICJoZWlnaHQiOiAiIg0KICAgICAgICB9Ow0KICAgICAgICB2YXIgd2ggPSAkKHdpbmRvdykuaGVpZ2h0KCk7DQoNCiAgICAgICAgaWYgKG9wdGlvbnMucGVyY2VudCkgew0KICAgICAgICAgICAgdW5pdCA9ICIlIjsNCiAgICAgICAgICAgIGlubmVyLmFkZENsYXNzKCJvdmVybGF5LXBlcmNlbnQiKTsNCiAgICAgICAgICAgIGlmIChpc0VkaXRNb2RlKCkpIHsNCiAgICAgICAgICAgICAgICBpbm5lci5hZGRDbGFzcygiZWRpdCIpDQogICAgICAgICAgICB9DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBpbm5lci5yZW1vdmVDbGFzcygib3ZlcmxheS1wZXJjZW50Iik7DQogICAgICAgICAgICBpZiAoaXNFZGl0TW9kZSgpKSB7DQogICAgICAgICAgICAgICAgaW5uZXIucmVtb3ZlQ2xhc3MoImVkaXQiKQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKG9wdGlvbnMud2lkdGgpIHsNCiAgICAgICAgICAgIGNzc1sid2lkdGgiXSA9IG9wdGlvbnMud2lkdGggKyB1bml0Ow0KICAgICAgICB9DQogICAgICAgIGlmIChvcHRpb25zLmhlaWdodCkgew0KICAgICAgICAgICAgY3NzWyJoZWlnaHQiXSA9IG9wdGlvbnMuaGVpZ2h0ICsgdW5pdDsNCiAgICAgICAgfQ0KDQogICAgICAgIGNzc1sibWF4LWhlaWdodCJdID0gKHdoIC0gbWFyZ2luVG9wIC0gMC4xICogd2gpICsgInB4IjsNCg0KICAgICAgICBjb250ZW50LmNzcyhjc3MpOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGdldFVybFZhcmlhYmxlcyh1cmwpIHsNCiAgICAgICAgdmFyIHEgPSB1cmwuc3BsaXQoJz8nKVsxXSwNCiAgICAgICAgICAgIHZhcnMgPSBbXSwNCiAgICAgICAgICAgIGhhc2g7DQoNCiAgICAgICAgaWYgKHEgIT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICBxID0gcS5zcGxpdCgnJicpOw0KICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBxLmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAgICAgICAgaGFzaCA9IHFbaV0uc3BsaXQoJz0nKTsNCiAgICAgICAgICAgICAgICB2YXJzLnB1c2goaGFzaFsxXSk7DQogICAgICAgICAgICAgICAgdmFyc1toYXNoWzBdXSA9IGhhc2hbMV07DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gdmFyczsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBnZXRTaXplKHZhcnMpIHsNCiAgICAgICAgdmFyIG9iaiA9IHt9Ow0KDQogICAgICAgIGlmICh2YXJzWyJ3aWR0aCJdICE9PSBudWxsKSB7DQogICAgICAgICAgICBvYmpbIndpZHRoIl0gPSB2YXJzWyJ3aWR0aCJdOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKHZhcnNbImhlaWdodCJdICE9PSBudWxsKSB7DQogICAgICAgICAgICBvYmpbImhlaWdodCJdID0gdmFyc1siaGVpZ2h0Il07DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gb2JqOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGNoZWNrSW50ZXJuYWwodXJsKSB7DQogICAgICAgIGlmICh1cmwuaW5kZXhPZihob3N0KSA+IC0xKSB7DQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgfQ0KICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gY2hlY2tJbWFnZSh1cmwpIHsNCiAgICAgICAgdmFyIGV4dCA9IHVybC5zcGxpdCgiPyIpWzBdLnNwbGl0KCcuJykucG9wKCk7DQogICAgICAgIGlmICgkLmluQXJyYXkoZXh0LCBbJ2dpZicsICdwbmcnLCAnanBnJywgJ2pwZWcnXSkgPiAtMSkgew0KICAgICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgfQ0KDQoNCiAgICBmdW5jdGlvbiBsb2FkT3ZlcmxheSh1cmwsIG92ZXJsYXkpIHsNCiAgICAgICAgdmFyIGNvbnRlbnQgPSBvdmVybGF5LmZpbmQoIi5vdmVybGF5LWlubmVyIiksDQogICAgICAgICAgICBvdmVybGF5Q29udGVudCA9IG92ZXJsYXkuZmluZCgiLmNvbXBvbmVudC1jb250ZW50IiksDQogICAgICAgICAgICB2YXJzID0gZ2V0VXJsVmFyaWFibGVzKHVybCksDQogICAgICAgICAgICBpbnRlcm5hbExpbmsgPSBjaGVja0ludGVybmFsKHVybCksDQogICAgICAgICAgICBvdmVybGF5U2l6ZSA9IGdldFNpemUodmFycyksDQogICAgICAgICAgICBzdWZmaXg7DQogICAgICAgIG92ZXJsYXlDb250ZW50LmFkZENsYXNzKCdvdmVybGF5RnVsbFdpZHRoJyk7DQogICAgICAgIGNvbnRlbnQucmVtb3ZlQXR0cignc3R5bGUnKTsNCiAgICAgICAgaWYgKGludGVybmFsTGluaykgew0KICAgICAgICAgICAgaWYgKGNoZWNrSW1hZ2UodXJsKSkgew0KICAgICAgICAgICAgICAgIGNvbnRlbnQuZW1wdHkoKS5hcHBlbmQoJCgiPGltZz4iLCB7IHNyYzogdXJsIH0pKTsNCiAgICAgICAgICAgICAgICBjb250ZW50LmNzcyhvdmVybGF5U2l6ZSk7DQogICAgICAgICAgICAgICAgb3ZlcmxheUNvbnRlbnQucmVtb3ZlQ2xhc3MoJ292ZXJsYXlGdWxsV2lkdGgnKTsNCiAgICAgICAgICAgICAgICBzaG93T3ZlcmxheShvdmVybGF5KTsNCiAgICAgICAgICAgIH0gZWxzZSBpZiAodXJsLmluZGV4T2YoIm92ZXJsYXl0eXBlPWlmcmFtZSIpID4gLTEpIHsNCiAgICAgICAgICAgICAgICBjb250ZW50LmVtcHR5KCkuYXBwZW5kKCQoIjxpZnJhbWU+IiwgeyBzcmM6IHVybCwgc3R5bGU6ICJ3aWR0aDogMTAwJTsgaGVpZ2h0OiAxMDAlIiB9KSk7DQogICAgICAgICAgICAgICAgY29udGVudC5jc3Mob3ZlcmxheVNpemUpOw0KICAgICAgICAgICAgICAgIHNob3dPdmVybGF5KG92ZXJsYXkpOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICBpZiAoaXNQcmV2aWV3TW9kZSgpKSB7DQogICAgICAgICAgICAgICAgICAgIHN1ZmZpeCA9ICJjZl9vdmVybGF5PTEiOw0KICAgICAgICAgICAgICAgICAgICB1cmwgPSB1cmwucmVwbGFjZSgic2l0ZWNvcmUvc2hlbGwvIik7DQogICAgICAgICAgICAgICAgICAgIHVybCArPSAodXJsLmluZGV4T2YoIj8iKSA9PSAtMSA/ICI/IiA6ICImIikgKyBzdWZmaXg7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgJC5nZXQodXJsLCBmdW5jdGlvbihkYXRhKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBvdmVybGF5RGF0YSA9ICQoZGF0YSkuYmVmb3JlKCkuZmlyc3QoKTsNCg0KICAgICAgICAgICAgICAgICAgICByZXNpemVPdmVybGF5KGNvbnRlbnQsIG92ZXJsYXlDb250ZW50LCB7DQogICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogb3ZlcmxheURhdGEuYXR0cigiZGF0YS13aWR0aCIpLA0KICAgICAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiBvdmVybGF5RGF0YS5kYXRhKCJoZWlnaHQiKSwNCiAgICAgICAgICAgICAgICAgICAgICAgIHBlcmNlbnQ6IG92ZXJsYXlEYXRhLmRhdGEoInBlcmNlbnQiKQ0KICAgICAgICAgICAgICAgICAgICB9KTsNCg0KICAgICAgICAgICAgICAgICAgICBjb250ZW50LmVtcHR5KCkuYXBwZW5kKGRhdGEpOw0KICAgICAgICAgICAgICAgICAgICBYQS5pbml0KCk7DQogICAgICAgICAgICAgICAgICAgIHNob3dPdmVybGF5KG92ZXJsYXkpOw0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgaWYgKGNoZWNrSW1hZ2UodXJsKSkgew0KICAgICAgICAgICAgICAgIGNvbnRlbnQuZW1wdHkoKS5hcHBlbmQoJCgiPGltZz4iLCB7IHNyYzogdXJsIH0pKTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgY29udGVudC5lbXB0eSgpLmFwcGVuZCgkKCI8aWZyYW1lID4iLCB7IHNyYzogdXJsLCBzdHlsZTogIndpZHRoOiAxMDAlOyBoZWlnaHQ6IDEwMCUiIH0pKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGNvbnRlbnQuY3NzKG92ZXJsYXlTaXplKTsNCiAgICAgICAgICAgIHNob3dPdmVybGF5KG92ZXJsYXkpOw0KICAgICAgICB9DQoNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBwcmVTaG93T3ZlcmxheShvdmVybGF5KSB7DQogICAgICAgIG92ZXJsYXkuY3NzKHsNCiAgICAgICAgICAgICJvcGFjaXR5IjogMQ0KICAgICAgICB9KS5zaG93KCk7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gc2hvd092ZXJsYXkob3ZlcmxheSkgew0KICAgICAgICB2YXIgaSwgcSwgbGlua3MsIGNsb3NlLCBjb250ZW50Ow0KICAgICAgICBvdmVybGF5LnNob3coKS5hbmltYXRlKHsNCiAgICAgICAgICAgIG9wYWNpdHk6IDENCiAgICAgICAgfSk7DQoNCiAgICAgICAgY2xvc2UgPSBvdmVybGF5LmZpbmQoIi5vdmVybGF5LWNsb3NlIik7DQogICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7IGNsb3NlLmZvY3VzKCk7IH0sIDApOw0KICAgICAgICBsaW5rcyA9IG92ZXJsYXkuZmluZCgiYTpub3QoLm92ZXJsYXktY2xvc2UpIik7DQogICAgICAgIGkgPSAyOw0KICAgICAgICBmb3IgKHEgPSAwOyBxIDwgbGlua3MubGVuZ3RoOyBxKyspIHsNCiAgICAgICAgICAgICQobGlua3NbcV0pLmF0dHIoInRhYkluZGV4IiwgaSsrKTsNCiAgICAgICAgfQ0KICAgICAgICBjb250ZW50ID0gb3ZlcmxheS5maW5kKCIub3ZlcmxheS1pbm5lciIpOw0KICAgICAgICBjb250ZW50LmF0dHIoInRhYkluZGV4IiwgaSk7DQogICAgICAgIGNvbnRlbnQuYmx1cihmdW5jdGlvbihhcmdzKSB7DQogICAgICAgICAgICBhcmdzLnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgICAgICBhcmdzLnN0b3BQcm9wYWdhdGlvbigpOw0KICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHsgY2xvc2UuZm9jdXMoKSB9LCAwKTsNCiAgICAgICAgfSk7DQoNCiAgICAgICAgWEFDb250ZXh0LlRyYWNraW5nLnRyYWNrKA0KICAgICAgICAgICAgWEFDb250ZXh0LkRvbWFpbi5UcmFja2luZ1R5cGVzKCkuZXZlbnQsIHsNCiAgICAgICAgICAgICAgICBjYXRlZ29yeTogIk92ZXJsYXkiLA0KICAgICAgICAgICAgICAgIGV2ZW50OiAib3BlbiIsDQogICAgICAgICAgICAgICAgbGFiZWw6IGxhYmVsLA0KICAgICAgICAgICAgICAgIGRhdGE6IDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAic3luYyINCiAgICAgICAgKTsNCiAgICAgICAgcmV0dXJuIG92ZXJsYXk7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gaGlkZU92ZXJsYXkob3ZlcmxheSkgew0KICAgICAgICB2YXIgY29udGVudCA9IG92ZXJsYXkuZmluZCgiLm92ZXJsYXktaW5uZXIiKTsNCg0KICAgICAgICBvdmVybGF5LmFuaW1hdGUoeyBvcGFjaXR5OiAwIH0sDQogICAgICAgICAgICBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICBvdmVybGF5LmhpZGUoKTsNCiAgICAgICAgICAgICAgICBjb250ZW50LmVtcHR5KCk7DQoNCiAgICAgICAgICAgICAgICBpZiAobWVqcykgew0KICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBwIGluIG1lanMucGxheWVycykgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCQoIiMiICsgbWVqcy5wbGF5ZXJzW3BdLmlkKS5wYXJlbnRzKCIub3ZlcmxheSIpLmxlbmd0aCA9PSAxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgJCgiIyIgKyBtZWpzLnBsYXllcnNbcF0uaWQgKyAnIHZpZGVvJykuYXR0cignc3JjJywgJycpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lanMucGxheWVyc1twXS5yZW1vdmUoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZWpzLnBsYXllcnMuc3BsaWNlKHAsIDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICApOw0KDQogICAgICAgIFhBQ29udGV4dC5UcmFja2luZy50cmFjaygNCiAgICAgICAgICAgIFhBQ29udGV4dC5Eb21haW4uVHJhY2tpbmdUeXBlcygpLmV2ZW50LCB7DQogICAgICAgICAgICAgICAgY2F0ZWdvcnk6ICJPdmVybGF5IiwNCiAgICAgICAgICAgICAgICBldmVudDogImNsb3NlIiwNCiAgICAgICAgICAgICAgICBsYWJlbDogbGFiZWwsDQogICAgICAgICAgICAgICAgZGF0YTogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICJzeW5jIg0KICAgICAgICApOw0KICAgICAgICByZXR1cm4gb3ZlcmxheTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBjcmVhdGVPdmVybGF5KCkgew0KICAgICAgICB2YXIgb3ZlcmxheSA9ICI8ZGl2IGNsYXNzPSdvdmVybGF5LXdyYXBwZXInPiIgKw0KICAgICAgICAgICAgIjxkaXYgY2xhc3M9J292ZXJsYXkgY29tcG9uZW50Jz4iICsNCiAgICAgICAgICAgICI8ZGl2IGNsYXNzPSdjb21wb25lbnQtY29udGVudCc+IiArDQogICAgICAgICAgICAiPGRpdiBjbGFzcz0nb3ZlcmxheS1jbG9zZSc+PC9kaXY+IiArDQogICAgICAgICAgICAiPGRpdiBjbGFzcz0nb3ZlcmxheS1pbm5lcicgdGFiSW5kZXg9JzInPjwvZGl2PiIgKw0KICAgICAgICAgICAgIjwvZGl2PiIgKw0KICAgICAgICAgICAgIjwvZGl2PiIgKw0KICAgICAgICAgICAgIjwvZGl2PiI7DQoNCiAgICAgICAgJCgiYm9keSIpLmFwcGVuZChvdmVybGF5KTsNCiAgICB9DQoNCiAgICBhcGkuaW5pdCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICB2YXIgb3ZlcmxheUNvbnRlbnQsDQogICAgICAgICAgICBvdmVybGF5U291cmNlLA0KICAgICAgICAgICAgb3ZlcmxheUlubmVyLA0KICAgICAgICAgICAgb3ZlcmxheUNsb3NlTGluaywNCiAgICAgICAgICAgIGNsb3NlQWN0aW9uLA0KICAgICAgICAgICAgb3ZlcmxheUNsaWNrU291cmNlOw0KICAgICAgICBpZiAoIW92ZXJsYXlQbGFjZWhvbGRlciAmJiBoYXNPdmVybGF5Q29udGVudCgpKSB7DQogICAgICAgICAgICBjcmVhdGVPdmVybGF5KCk7DQogICAgICAgIH0NCg0KICAgICAgICBpZiAoaXNPdmVybGF5UGFnZSgpKSB7DQogICAgICAgICAgICB2YXIgcGFnZSA9ICQoIi5vdmVybGF5LXBhZ2UiKSwNCiAgICAgICAgICAgICAgICBvdmVybGF5ID0gJCgiI3Nwbk92ZXJsYXkiKSwNCiAgICAgICAgICAgICAgICBjb250ZW50ID0gb3ZlcmxheUNvbnRlbnQuY2hpbGRyZW4oIi5vdmVybGF5LWlubmVyIik7DQogICAgICAgICAgICBvdmVybGF5Q29udGVudCA9IHBhZ2UuY2hpbGRyZW4oIi5jb21wb25lbnQtY29udGVudCIpOw0KDQogICAgICAgICAgICByZXNpemVPdmVybGF5KGNvbnRlbnQsIG92ZXJsYXlDb250ZW50LCB7DQogICAgICAgICAgICAgICAgd2lkdGg6IG92ZXJsYXkuZGF0YSgid2lkdGgiKSwNCiAgICAgICAgICAgICAgICBoZWlnaHQ6IG92ZXJsYXkuZGF0YSgiaGVpZ2h0IiksDQogICAgICAgICAgICAgICAgcGVyY2VudDogb3ZlcmxheS5kYXRhKCJwZXJjZW50IikNCiAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgb3ZlcmxheUNvbnRlbnQub24oImNsaWNrIiwgZnVuY3Rpb24oZXZlbnQpIHsNCiAgICAgICAgICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTsNCiAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgcGFnZS5vbigiY2xpY2siLCBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICBpZiAoaXNQcmV2aWV3TW9kZSgpKSB7DQogICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uLmhyZWYgPSBsb2NhdGlvbi5ocmVmLnJlcGxhY2UoInNjX21vZGU9cHJldmlldyIsICJzY19tb2RlPWVkaXQiKQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0pOw0KICAgICAgICB9DQogICAgICAgIG92ZXJsYXkgPSAkKCIub3ZlcmxheS13cmFwcGVyID4gLm92ZXJsYXkiKTsNCiAgICAgICAgb3ZlcmxheUNvbnRlbnQgPSBvdmVybGF5LmZpbmQoIi5jb21wb25lbnQtY29udGVudCIpOw0KICAgICAgICBvdmVybGF5U291cmNlID0gJCgiLm92ZXJsYXktc291cmNlIGE6bm90KC5pbml0aWFsaXplZCksIGEub3ZlcmxheS1zb3VyY2U6bm90KC5pbml0aWFsaXplZCkiKTsNCiAgICAgICAgb3ZlcmxheUlubmVyID0gJCgiLm92ZXJsYXktaW5uZXIiKTsNCiAgICAgICAgb3ZlcmxheUNsb3NlTGluayA9IG92ZXJsYXkuZmluZCgiLm92ZXJsYXktY2xvc2UiKTsNCiAgICAgICAgY2xvc2VBY3Rpb247DQogICAgICAgIG92ZXJsYXlDbGlja1NvdXJjZTsNCg0KICAgICAgICBjbG9zZUFjdGlvbiA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgaGlkZU92ZXJsYXkob3ZlcmxheSk7DQogICAgICAgICAgICBvdmVybGF5SW5uZXIub2ZmKCJibHVyIik7DQogICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgIGlmIChvdmVybGF5Q2xpY2tTb3VyY2UgIT0gbnVsbCkgew0KICAgICAgICAgICAgICAgICAgICBvdmVybGF5Q2xpY2tTb3VyY2UuZm9jdXMoKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9LCAwKTsNCiAgICAgICAgfTsNCg0KICAgICAgICBpZiAoIW92ZXJsYXlQbGFjZWhvbGRlcikgew0KICAgICAgICAgICAgb3ZlcmxheUNvbnRlbnQub24oImNsaWNrIiwgZnVuY3Rpb24oZXZlbnQpIHsNCiAgICAgICAgICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTsNCiAgICAgICAgICAgIH0pOw0KDQogICAgICAgICAgICBvdmVybGF5Lm9uKCJjbGljayIsIGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgIGNsb3NlQWN0aW9uKCk7DQogICAgICAgICAgICB9KTsNCg0KICAgICAgICAgICAgJCgiYm9keSIpLmtleXVwKGZ1bmN0aW9uIChhcmdzKSB7DQogICAgICAgICAgICAgICAgaWYgKGFyZ3Mud2hpY2ggPT09IDI3KSB7DQogICAgICAgICAgICAgICAgICAgIGFyZ3Muc3RvcFByb3BhZ2F0aW9uKCk7DQogICAgICAgICAgICAgICAgICAgIGNsb3NlQWN0aW9uKCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSk7DQoNCiAgICAgICAgICAgIG92ZXJsYXlDbG9zZUxpbmsub24oImNsaWNrIiwgZnVuY3Rpb24oYXJncykgew0KICAgICAgICAgICAgICAgIGFyZ3MucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgICAgICAgICBjbG9zZUFjdGlvbigpOw0KICAgICAgICAgICAgfSk7DQoNCiAgICAgICAgICAgICQod2luZG93KS5vbigicmVzaXplIiwgZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgdmFyIGhlaWdodCA9ICQod2luZG93KS5oZWlnaHQoKTsNCiAgICAgICAgICAgICAgICBoZWlnaHQgPSBoZWlnaHQgLSBtYXJnaW5Ub3AgLSAwLjEgKiBoZWlnaHQ7DQogICAgICAgICAgICAgICAgb3ZlcmxheUNvbnRlbnQuY3NzKCJtYXgtaGVpZ2h0IiwgaGVpZ2h0ICsgInB4Iik7DQogICAgICAgICAgICB9KTsNCg0KICAgICAgICAgICAgb3ZlcmxheVBsYWNlaG9sZGVyID0gdHJ1ZTsNCiAgICAgICAgfQ0KDQoNCiAgICAgICAgb3ZlcmxheVNvdXJjZS5lYWNoKGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgaWYgKGlzRWRpdE1vZGUoKSkgew0KICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgJCh0aGlzKS5vbigiY2xpY2siLCBmdW5jdGlvbihldmVudCkgew0KICAgICAgICAgICAgICAgIG92ZXJsYXlDbGlja1NvdXJjZSA9IGV2ZW50LmN1cnJlbnRUYXJnZXQ7DQogICAgICAgICAgICAgICAgaWYgKCFpc0VkaXRNb2RlKCkpIHsNCiAgICAgICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgICAgICAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7DQogICAgICAgICAgICAgICAgICAgIHByZVNob3dPdmVybGF5KG92ZXJsYXksIG92ZXJsYXlDb250ZW50KTsNCg0KICAgICAgICAgICAgICAgICAgICB2YXIgdXJpID0gdGhpcy5ocmVmOw0KICAgICAgICAgICAgICAgICAgICBsb2FkT3ZlcmxheSh1cmksIG92ZXJsYXkpOw0KDQogICAgICAgICAgICAgICAgICAgIHZhciBocmVmID0gdGhpcy5ocmVmLnNwbGl0KCcvJyk7DQogICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDw9IGhyZWYubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsID0gaHJlZi5wb3AoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsYWJlbC5sZW5ndGggPT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9KTsNCg0KICAgICAgICAgICAgLy8gJCh0aGlzKS5vbignZm9jdXMnLCBmdW5jdGlvbihhcmdzKSB7DQogICAgICAgICAgICAvLyAgICAgLy9hcmdzLnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgICAgICAvLyAgICAgaWYgKGFyZ3MuY3VycmVudFRhcmdldCA9PT0gb3ZlcmxheUNsaWNrU291cmNlKSB7DQogICAgICAgICAgICAvLyAgICAgICAgIG92ZXJsYXlDbGlja1NvdXJjZSA9IG51bGw7DQogICAgICAgICAgICAvLyAgICAgfQ0KICAgICAgICAgICAgLy8gfSk7DQoNCiAgICAgICAgICAgICQodGhpcykuYWRkQ2xhc3MoImluaXRpYWxpemVkIik7DQogICAgICAgIH0pOw0KDQoNCiAgICB9Ow0KDQogICAgcmV0dXJuIGFwaTsNCg0KfShqUXVlcnkpOw0KDQpYQS5yZWdpc3Rlcigib3ZlcmxheSIsIFhBLmNvbXBvbmVudC5vdmVybGF5KTs=
- ID: "6954b7c7-2487-423f-8600-436cb3b6dc0e"
  Hint: Size
  Value: 11531
- ID: "6f47a0a5-9c94-4b48-abeb-42d38def6054"
  Hint: Mime Type
  Value: "application/x-javascript"
- ID: "c06867fe-9a43-4c7d-b739-48780492d06f"
  Hint: Extension
  Value: js
Languages:
- Language: en
  Versions:
  - Version: 1
    Fields:
    - ID: "25bed78c-4957-4165-998a-ca1b52f67497"
      Hint: __Created
      Value: 20160811T135343Z
  - Version: 2
    Fields:
    - ID: "25bed78c-4957-4165-998a-ca1b52f67497"
      Hint: __Created
      Value: 20160811T135343Z
